"use strict";var _createClass=function(){function s(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(t,s.key,s)}}return function(t,e,a){if(e)s(t.prototype,e);if(a)s(t,a);return t}}();function _classCallCheck(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}var Catalog=function(){function e(t){_classCallCheck(this,e);this.options={catalog_class:"",catalog_activeclass:"",selector:"h1,h2,h3,h4,h5,h6",hover_class:"",contentEl:"",catalogEl:""};this.tags=null;this.content=null;this.prev=null;this._init(t)}_createClass(e,[{key:"_init",value:function t(e){this.options=Object.assign({},this.options,e);if(!this.options.catalogEl||!this.options.catalogEl){console.warn("catalogEl Or contentEl is undefined");return}this.content=document.querySelector(this.options.contentEl);if(!this.content){console.warn("the dom of "+this.options.contentEl+" is not found");return}this.tags=document.querySelectorAll(this.options.selector);this.tags=this.findParants();var a=this.getTree();var s=this.getHtml(a);document.querySelector(this.options.catalogEl).innerHTML='<div class="wrapper"><div class="hover"></div>'+s+"</div>";this.activeIndex();this._bind();window.addEventListener("scroll",this.activeIndex.bind(this))}},{key:"_bind",value:function t(){var s=this;document.querySelector(this.options.catalogEl).addEventListener("click",function(t){if(t.target.tagName=="UL")return;if(s.prev){s.prev.className=s.prev.className.replace("active","")}t.target.className=t.target.className+" active";s.prev=t.target;var e=t.target.getAttribute("data-catalog");var a=document.getElementById(e).getBoundingClientRect();document.getElementsByClassName("hover")[0].style.top=t.target.offsetTop+"px";window.scrollBy({top:a.y,behavior:"smooth"})})}},{key:"findParants",value:function t(){var e=[];for(var a=0;a<this.tags.length;a++){this.tags[a].id="head-"+a;var s={title:this.tags[a].innerText||tags[a].textContent,tagName:this.tags[a].tagName,id:"head-"+a,parent:"",children:[]};if(a==0){e.push(s);continue}for(var i=a-1;i>=0;i--){if(this.tags[a].tagName.replace("H","")>this.tags[i].tagName.replace("H","")){s.parent=this.tags[i].id;e.push(s);break}else if(i==0){e.push(s)}}}return e}},{key:"getTree",value:function t(){var a=[];var s={};this.tags.forEach(function(t){s[t.id]=t});this.tags.forEach(function(t){var e=s[t.parent];if(e){e.children.push(t)}else{a.push(t)}});return a}},{key:"getHtml",value:function t(e){var a='<ul class="catalog-ul">';var s="</ul>";var i="";for(var n=0;n<e.length;n++){if(e[n].children.length>0){i=i+('<li class="catalog-li" data-catalog="'+e[n].id+'">'+e[n].title+"</li>")+this.getHtml(e[n].children)}else{i=i+('<li class="catalog-li" data-catalog="'+e[n].id+'">'+e[n].title+"</li>")}}return a+i+s}},{key:"activeIndex",value:function t(){var e=document.querySelector(this.options.contentEl).querySelectorAll(this.options.selector);var a=[];for(var s=0;s<e.length;s++){a.push(document.getElementById(e[s].id).getBoundingClientRect())}for(var i=0;i<a.length;i++){if(a[i].bottom>0){var n=document.querySelector(this.options.catalogEl).getElementsByTagName("li")[i];if(this.prev){this.prev.className=this.prev.className.replace("active","")}n.className=n.className+" active";this.prev=n;document.getElementsByClassName("hover")[0].style.top=n.offsetTop+"px";return}}var n=document.querySelector(this.options.catalogEl).getElementsByTagName("li")[0];if(this.prev){this.prev.className=this.prev.className.replace("active","")}n.className=n.className+" active";this.prev=n;document.getElementsByClassName("hover")[0].style.top=n.offsetTop+"px"}}]);return e}();